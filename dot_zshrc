# zmodload zsh/zprof

# Zinit
source ~/.zsh/zinit.zsh

source ~/.zsh/tmux.zsh
source ~/.zsh/alias.zsh

# Shell integrations
# source <(fzf --zsh)
eval "$(zoxide init --cmd cd zsh)"
eval "$(atuin init zsh)"
eval $(thefuck --alias)
eval "$(fnm env --use-on-cd --shell zsh)"

# only source arch if the system is arch linux
if [[ -f ~/.zsh/arch.zsh && -d /etc/arch-release ]]; then
  source ~/.zsh/arch.zsh
fi

# History
HISTFILE=~/.zsh_history
HISTSIZE=5000
SAVEHIST=$HISTSIZE
HISTDUP=erase
setopt appendhistory
setopt sharehistory
setopt hist_ignore_dups
setopt hist_ignore_all_dups
setopt hist_save_no_dups
setopt hist_find_no_dups

# Completion styling
zstyle ':completion:*:git-checkout:*' sort false
zstyle ':completion:*:descriptions' format '[%d]'
zstyle ':completion:*' list-colors ${(s.:.)LS_COLORS}
zstyle ':completion:*' menu no
zstyle ':fzf-tab:complete:cd:*' fzf-preview 'eza -1 --color=always $realpath'
# zstyle ':fzf-tab:*' fzf-flags --color=fg:1,fg+:2 --bind=tab:accept
zstyle ':fzf-tab:*' use-fzf-default-opts yes
zstyle ':fzf-tab:*' switch-group '<' '>'

# bind zsh zsh-autosuggestions accept to same as my neovim copilot
bindkey '^f' autosuggest-accept

# color of zsh-autosuggestions
ZSH_AUTOSUGGEST_HIGHLIGHT_STYLE='fg=#6c6f85'

# if whoami is sandeep450.kumar then export node unsafe environment variables as on work laptop zcaler hinders npm install
if [[ "$(whoami)" == "sandeep450.kumar" ]]; then
  # disable TLS certificate validation for Node.js
  export NODE_TLS_REJECT_UNAUTHORIZED=0

  # disable strict SSL checks in npm
  npm config set strict-ssl false >/dev/null 2>&1
fi

# zprof
